package me.supersilverstone.plugintutorial;

import me.supersilverstone.plugintutorial.episode2.events;
import me.supersilverstone.plugintutorial.episode3.playerListener;
import me.supersilverstone.plugintutorial.episode4.feed;
import me.supersilverstone.plugintutorial.episode5.message;
import me.supersilverstone.plugintutorial.episode6.coinflip;
import org.bukkit.Bukkit;
import org.bukkit.configuration.file.FileConfiguration;
import org.bukkit.configuration.file.YamlConfiguration;
import org.bukkit.plugin.java.JavaPlugin;

import java.io.File;

public final class PluginTutorial extends JavaPlugin {

    //todo Episode 7
    private FileConfiguration config;

    @Override
    public void onEnable() {
        // Plugin startup logic

        //todo Episode 1
        // N/A

        //todo Episode 2
        Bukkit.getPluginManager().registerEvents(new events(), this);

        //todo Episode 3
        Bukkit.getPluginManager().registerEvents(new playerListener(), this);

        //todo Episode 4
        getCommand("feed").setExecutor(new feed());

        //todo Episode 5
        getCommand("message").setExecutor(new message());

        //todo Episode 6
        getCommand("coinflip").setExecutor(new coinflip());

        //todo Episode 7
            // Create the plugin's data folder if it doesn't exist
        if (!getDataFolder().exists()) {
            getDataFolder().mkdirs();
        }
            // Specify the file path and name
        File configFile = new File(getDataFolder(), "config.yml");

            // Check if the config file exists; if not, create a new one
        if (!configFile.exists()) {
            saveResource("config.yml", false);
        }

            // Load the config
        config = YamlConfiguration.loadConfiguration(configFile);

            // Access Config File
            // Example for the Config
        String message1 = config.getString("message");
        int count1 = config.getInt("count");
        boolean enabled1 = config.getBoolean("enabled");

            // Pre-Enabled
        String message2 = config.getString("message", "Hello, world!");
        int count2 = config.getInt("count", 5);
        boolean enabled2 = config.getBoolean("enabled", true);

            // Modify Config File
        config.set("message", "Welcome to the server!");
        config.set("count", 10);
        config.set("enabled", false);

            // Save the Config
        saveConfig();

    }

    @Override
    public void onDisable() {
        // Plugin shutdown logic
    }

    private void saveConfig() {
        try {
            config.save(new File(getDataFolder(), "config.yml"));
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

}
